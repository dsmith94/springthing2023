let n=!1;const t=()=>{if(!n){const a=document.createElement("div"),o=(a.className="menu",document.createElement("div"));o.style=`
      max-width: 400px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
    `;let e=[];r.map&&(e=r.map.sort().filter(e=>r[e]?.location!==r.currentLocationName)).map(t=>{var e;r[t].location&&((e=document.createElement("button")).innerText=r[t].name,e.style="width: 80vw;",e.onclick=()=>{const e=document.createElement("div");e.className="outMenu",e.innerHTML=a.innerHTML,n=!1,a.remove(),l(),u(),T(r[t].location)(),document.body.appendChild(e),setTimeout(()=>{e.remove()},400)},o.appendChild(e))});var t=document.createElement("button");t.style="aspect-ratio: 1; font-size: 32pt; font-weight: bold; width: 64px; height: 64px;",t.innerText="⤒",t.onclick=()=>{n=!1,a.remove();const e=document.createElement("div");e.className="outMenu",e.innerHTML=a.innerHTML,document.body.appendChild(e),setTimeout(()=>{e.remove()},400)},0<e.length&&(o.appendChild(t),a.appendChild(o),document.body.appendChild(a))}};let r={},d={};const h=(e,t=!1)=>{let a=0;const o=t?"div":"p";return e.split("\n").map(e=>e.trim()).join("\n").split("\n\n").filter(e=>""!==e).map(e=>`<${o}>${(o=>{const n={quote:!0,bold:!0,italic:!0};var e=(e,t,a)=>{for(;-1<o.indexOf(e);)o=n[t]?o.replace(e,`<${a}>`):o.replace(e,`</${a}>`),n[t]=!n[t]},t=(t,a)=>o=o.split("\n").map(e=>0===e.trimStart().indexOf(t)?`<${a}>${e.replace(t,"")}</${a}>`:e).join("\n");for(t("#### ","h4"),t("### ","h3"),t("## ","h2"),t("# ","h1");-1<o.indexOf("[[");)o=a%2==0?o.replace("[[","&ldquo;"):o.replace("[[","&lsquo;"),a+=1;for(;-1<o.indexOf("]]");)--a,o=a%2==0?o.replace("]]","&rdquo;"):o.replace("]]","&rsquo;");for(e("``","quote","q"),e('"',"quote","q"),e("**","bold","b"),e("*","italic","i");-1<o.indexOf("'");)o=o.replace("'","&rsquo;");return o=o.trim()})(e)}</${o}>`).join("")};function o(e){var t=0;if(0!=e.length)for(i=0;i<e.length;i++)t=(t<<5)-t+(char=e.charCodeAt(i)),t&=t;return t}Game.Stockford={name:"the man with the pewter cup",location:"insideClub",hasMet:!1,notMet:()=>`
    
    A sturdy little man with very black hair and a wide nose sat
    studying me from a table in the corner. He clutched in his considerable grip a pewter
    cup that may have been full of coffee, but was almost assuredly rum.
    
    `,desc:()=>`
    
    Stockford sat
    studying me from a table in the corner. He gripped his pewter cup of
    rum as though it were a lifeline. 
    
    
    `,talk:()=>{f("Stockford"),k(`
        
        At sat at his table. "You, I perceive, are Mr Stockford."
        
        "That's right," said the man with a nervous stare and a low voice. "Are you with the Scotland Yard?"    
        
        `),m('"Not precisely, but I work with them."',()=>{k(`

            "Not precisely, but I work with them," I said.

            He glanced around the room like a hunted beast. "It's dangerous to talk too much,
            even in here. Can you protect me? I am being watched every hour."


            `),w("gettingDeeper")}),m('"Of course not. Who do you take me for?"',()=>{k(`
            
            "Of course not. Who do you take me for?" I said.

            He smiled as though he knew my secret. "Of course you don't."
            
            `),w("gettingDeeper")}),m('"Scotland Yard? The police force?"',()=>{k(`
            
            "Scotland Yard? The police force?" I said. "What sort of trouble are you in?"

            "The very worst—I daresay a matter of life and death."
            
            `),w("gettingDeeper")}),b('"Well, it has been a pleasure to meet you. Good-bye."')},scared:()=>{k(`"I've aided you enough," he said. "Now go get me the help you promised. I'll be here."`),b('"Thank you, Mr Stockford."')},moreDeep:()=>{k(`
            
        "He was a member of the Black Walrus Society?" I exclaimed.

        "Shhh. Of course he was. We was mates during the war, we was.
        One of the most gifted thieves of his kind. He stole ruthlessly, a virtuoso of larceny, until he decided to quit as a hero for Queen and country."

        His eyes darted around the room more nervously than before. “The Walrus spans the globe. In order to keep track of who
        he could trust, and who he couldn't, the ol' Captain kept a journal.

        “Charles Hob, a stupendous apothecary of most rancid villainy, wanted that record of conspirators with an almost consuming fire. But
        Bennett tricked him, and sent Hob and his closest lieutenants down to St. Helena.”
        
        `),m(`"But Hob didn't stay in St. Helena, did he?"`,()=>{k(`

            "But Hob didn't stay in St. Helena, did he?" I already knew the answer.
            
            "Precisely. Somehow, Hob escaped. Roger wished he'd hanged, or that he'd managed to off that monster himself."

            He leaned in close. "But Hob is alive. There are whispers from dark alleys that he has returned to London."

            The door slammed, echoing like the clap of a revolver. Someone had left the Club. The blood drained from
            Stockford's face.
            
            `),H("stockfordDoomed",1),w("scared")}),m('"And what came of Hob after that?"',()=>{k(`

            "And what came of Hob after that?" I asked.
            
            "I suspect Roger thought he'd hang," said Stockford, "Or perish under the cruel yoke of incarceration."
            
            He leaned in close. "Hob escaped. There are whispers from dark alleys that he has returned to London."

            The door slammed, echoing like the clap of a revolver. Someone had left the Club. The blood drained from
            Stockford's face.
            
            `),H("stockfordDoomed",1),w("scared")})},gettingDeeper:()=>{k(`

        "I can indeed assist you. But first you must assist me. How are you connected to the Black
        Walrus Society?"

        He rolled up the sleeve and the tattoo of a sinister walrus peeked out from beneath his cuff.
        "I want out, before my blighted soul licks the flames of perdition."
        
        `),m('"How long have you been a member?"',()=>{k(`

            "How long have you been a member?" I asked.
            
            "Since Roger recruited me," said Stockford.
            
            `),w("moreDeep")}),m('"Did you know Captain Roger Bennett?"',()=>{k(`
            
            "Did you know Captain Roger Bennett?" I asked.

            "Of course I did," said Stockford. "He recruited me."
            `),w("moreDeep")}),b('"Stay here while I get help."')}},Game.cabbie=()=>{k(`

    ${C(['The cabbie waited for me to take a seat. "Where to, miss?"',"I sat in the hansom and the cabbie turned to me.",`"Where ar' we headed today?" The cabbie impatiently waited for me to get in.`])}

    `),v("Enter a place name or address, like *11 West India Dock Road*.",t=>{var e=e=>-1<t.indexOf(e),a=()=>C([`"Of course, ma'am."`,'"Righty."','"Very good, miss."','"Right-o, miss."']);e("dock")||e("limeh")||e("chinat")?k("I don't need to go home yet."):e("spaul")||e("wareh")?(k(a()),m("One ride later...",T("outsideWarehouse"))):e("surr")?(k(a()),m("One ride later...",T("surrey"))):e("astl")||e("circus")?(k(a()),m("One ride later...",T("circus"))):e("scotlandy")?(k(`
            
            ${a()}
            
            `),m("One ride later...",T("scotlandYard"))):e("manor")?k(`
            
            I was about to go back to the scene of the crime when I recalled 
            Chief Inspector Gould's words about not returning while the
            official investigation was in process.
            
            `):k(`

        ${C([`"'Fraid I don't know how to get there," said the cabbie.`,'"Never heard of that place. Is it in London?"',`"I don't understand where you want me to take you," said the cabbie.`])}
    
        `)})},Game.circus=()=>{k(`
    
        Astley's Royal Circus was a grim gray theater in a sea of bleakness.
        The whole of the building was shut up and dark, but in the corner of my mind
        I could almost hear sinister organ music 
        
        A large rough door stood facing the street.
    
    `),e("Open the door","To no avail, the door is locked tight."),m("Knock on the door",()=>{k([`
        
            A pair of suspicious eyes meets me through a tiny slit. "The circus is closed," said a 
            brutish voice.
        
        `,`

            "How many times can I tell ye, the circus is closed!"

        `]),m(`"I'm here to see someone, on official business."`,()=>{k(`
            
              "You don't look much official," said the man. "Who are you here to see?"  
            
            `),v("Enter the name of a person, like *Bixby*.",e=>{-1<e.indexOf("aldi")?3===x("stockfordDoomed")?m(`"He's in here," said the man.`,T("insideCircus")):k(`
                        
                            "He's not present," said the man. "Come back later."
                        
                        `):k(`

                ${C([`"Never heard of 'im," said the man.`,'"Find someone else to pester,"  said the man.',`"That bloke doesn't work here," said the man.`])}
            
                `)})}),e('"I demand to be let inside, a man has been murdered!"',`
        
            "I demand to be let inside, a man has been murdered!" I cried.

            The man chuckled in response and mumbled: "Only in London."

        `),m('"Clearly I have the wrong address. Thank you, sir."',()=>{k(`
            
            "Clearly I have the wrong address. Thank you, sir."

            He responded with a weary hurumph.
            
            `)})}),m("Catch a cab",T("cabbie"))},Game.crimeScene=()=>{k(`
    
    The captain's room was dark. His body was on the bed, the ghastly visage of death
    on his face lit only by moonlight through the window. Luggage boxes where everywhere,
    as though thrown about the cargo hold of a ship, so there was only a narrow path
    of floor to walk. 
    
    `),m("Examine the captain",`
    
    Wrapped beneath his sheets were the pale remains of the Captain, naked as a plucked hen. His skin was icy and blue.
    Judging by the state of the rigor mortis, I ascertained he had met his unconscionable demise less than a few hours.
    The trachea in the neck was crushed.
    
    `),e("Examine the window",`
    
    Caked layers of dust and told me the window had not been opened in years, and for a fact,
    could not be opened without the force of three men.
    
    `),e("Examine the chests",()=>{H("foundHiddenChest",!0),k(`
    
    Most of the chests were empty. A few had some useless baubles acquired from more
    distant regions.

    One chest in particular struck me as unusual, as though not belonging with the rest of
    the collection.
    
    `)}),x("foundHiddenChest")&&m("Examine the unusual chest",`
    
    The strange chest was no more than about 3 foot long and 2 foot wide. There was a latch
    on the lock so it could be opened on the inside. It was empty, save for the rude odor
    of sweat and leather.

    Carved on the bottom, in lettering so faint as to be barely readable:
    
    *ASTLEY RT*
    
    `),m("Exit the crime scene",T("manorHouseFoyer"))},Game.insideCircus=()=>{k([`
    
        The man behind the door quickly whisked me inside. He struck me as an aging circus strongman, still muscular but 
        growing gray near his temples. "Aldi keeps to himself, mostly, in his room."
        
        The hallway headed back and around the main auditorium, to an unlit musty passage and into a small chamber with
        peeling yellow paint and the stench of rats.

        "Here you are," said my strongman companion. "You can wait here. Aldi will be along shortly."
    
    `,`
    
        Aldi's tiny flat was really just a small, unpleasant room. The windows were boarded over and peeling yellow paint
        barely stuck to the walls. On the far wall was a long trunk, the approximate size and shape of a coffin.
    
    `]),m("Investigate trunk",()=>{k(`
        
            A worn piece of luggage, which on close inspection revealed a latch so as to be openable from the inside.
            It appeared as though something was inside...
        
        `),m("Look closer",()=>{k(`
            
                A harsh blow struck the base of my cranium and I fell into the trunk. I came to seconds later in darkness.
            
            `),e("Open latch",`

                I attempted the latch to no avail.
            
                "Yellow wench," hissed a voice from outside the box. "In a bit over yer blouse, says I."
            
            `),e('"Release me!"',()=>{k(`
            
                "Release me!" I cried.

                "Not just yet," replied my unseen captor. "Perhaps if you can be more... Friendly."
            
                `),e('"As I am locked in a box, I believe you have the advantage on me?"',()=>{k(`
                    
                        "As I am locked in a box, I believe you have the advantage on me, do you not?" I said.

                        "Fair," said the captor, "Though it be on your own head for meddling in the affairs of the Walrus."
                    
                    `),m('"The Walrus? What are you talking about?"',()=>{k(`
                        
                            "The Walrus? What are you talking about?" I asked with no slight degree of incredulousness.

                            "Oh, so clever," said my captor. "Begins to panic, says I."
                        
                        `)}),m('"I only ever wanted to solve a murder."',()=>{k(`
                        
                            "I only ever wanted to solve a murder." I said.

                            "And look where that got you," came the response, with a audible sneer.
                        
                        `)})}),e('"How can one be friendly in the presence of a cold-blooded fiend?"',()=>{k(`
                    
                        "How can one be friendly in the presence of a cold-blooded fiend?" I inquired. "After all,
                        you are the malefactor who did in Roger Bennett."

                        "I took no pleasure in offing the Captain," said the voice.

                        "That's a lie."

                        He chortled. "True enough. But it's no lie he deserved what he got. 
                        Whatever you think about me, that man was worse. The traitorous wretch."
                    
                    `),m('"That still makes you a killer."',()=>{k(`
                        
                            "That still makes you a killer," I said.

                            "To be sure," said the voice. "But I harbour no guilt, no more than a man who uses
                            arsenic to kill an intensely pernicious rat." 
                        
                        `)}),m('"Perhaps. But the courts should decide."',()=>{k(`
                        
                            "Perhaps. But the courts should decide, not your confederates and fellow brigands."

                            The voice mumbled an oath and said: "Spare me your philosophical dreck."
                        
                        `)})})})})})};const a=()=>{H("stockfordDoomed",3),k(`
  
      "I believe we shall find that with the murderer himself," I said. A man who can fit inside a travelers trunk,
      open it from the inside after Bennett had gone to bed, and commit a most heinous deed. The Captain's own screams drew the attention
      of dear Mrs Werstrom outside the door.

      “Our culprit thus possessed ample time to return to his box, allow the door to be opened by force, wait until the coast was clear
      before leaving the scene.”

      "Hmm." Gould nodded. "I suppose this might be helpful, then. Bixby found this most fascinating connection this morning. A fellow,
      with the physical talents and gifts you describe, with ties to the Black Walrus Society."

      He produced from this coat a weathered circus advertisement, which read in loud block letters:

      <center><h4>Aldi the Amazing</h4></center>
      <center><h4>Master of Mystic Powers and Escape Artist Extraordinaire</h4></center>
  
  `),m(`"I believe we've found our rat,"`,()=>{k(`

      "I believe we've found our rat. Thank you, Chief Inspector."

      I stood up to leave the club. Gould sat where he was, deep in thought, clutching his pipe but seemingly unable to 
      smoke.

    `)})},e=(Game.manorGrounds=()=>{k(`

    A few humble rose bushes formed the basis of a tiny baroque garden just north of the manor house. The scent of
    newly dug dirt and floriferous perfume was heavy.
    Precious little could be seen under the cover of dark, but a small patch of fresh muddy soil appeared to have
    been disturbed recently.

    `),e("Investigate the disturbed soil",()=>{H("hob",!0),k(`
        
        Arming myself with a sturdy discarded branch, I began sifting through the soil until discovering a 
        homely little cherry wood box.

        Inside was a series of letters, each with a single short sentence:

        `),I("*We execute betrayers*"),I("*Hob remembers*"),I("*Your time is up*"),I(" "),k(`
        
        Each was flourished with a signature black India-ink scrawl of a
        walrus.
        
        `)}),m("Return to the manor house",T("manorHouseFoyer"))},Game.manorHouseFoyer=()=>{var e=x("hob")&&x("foundHiddenChest")&&x("foundBankAddress");e?k([`
        "Chief Inspector Gould has returned," said Bixby. "He is outside with transport to take you back to
        Limehouse, when you're finished here."
    `,`
        Bixby was listless. He appeared ready to leave.
    `]):k(`
        A clearly annoyed Detective Sergeant Bixby was dutifully waiting to aid me in my investigation.
    `),m('"Bixby, show me the crime scene."',()=>{T("crimeScene")()}),m('"Bixby, I will interview Mrs. Werstrom."',()=>{T("talkToWerstrom")()}),m('"Bixby, I will interview Mr. Thurman."',()=>{T("talkToThurman")()}),x("roseGarden")&&m(`"I'd like to investigate the grounds."`,()=>{g("manorGrounds")&&k(`"Of course," said Bixby, handing me a candle.
        "It's very dark tonight, so you'll need a light."`),T("manorGrounds")()}),m('"What do you think, Bixby?"',()=>{k('"What do you think, Bixby?" I asked.'),k([`"You're the China Doll," he said with no small derision. "Are you not the 
            nimblest mind in Europe?"`,'He shrugged. "Why are *you* asking me?"',"Bixby only scowled at the question."])}),e&&m("Depart for Limehouse",()=>{k(`
        
        Gould was in the hansom, waiting for me. "Any success, Madame?"

        "Perhaps. Does this symbol mean anything to you?" I showed him the letters from the garden. 
        He stared intently for some time at the walruses.

        "Come see me in the morning at Scotland Yard," he said to me, "And, if you would please, don't come back to the manor house.
        Official inquiry business, and no shortage of reporters. I would prefer if you stayed clear of the public light, Madame Soo."

        "Fine to my accord," said I. "I have no desire to return. Werstrom and Thurman are innocent. Our
        murderer has slipped away, back to Central London, if my deductive powers are not amiss."

        The ride continued in silence.
        
        `),m("The next morning...",T("streetsOfLondon"))})},Game.museum=()=>{k(`
    
    Bixby stared at me expectantly.
    
    `),v("Give Bixby a person or topic to research, like *Black Walrus*",t=>{var e=e=>-1<t.indexOf(e);e("walr")?k(`
        
        "The Black Walrus Society," said Bixby, handing me a stack of papers. "Never has there been a 
        greater international brood of wickedness. Money laundering, assassinations, theft on a large and
        small scale—they are the first and last name in crime."
  
        "So they're an organization of brigands?"
  
        "Precisely. Roger Bennett ended his career by putting away their brightest constellation in
        lockup on St. Helena. Their insignia is a walrus drawn in ink."
        
        `):e("capt")||e("benn")||e("roge")?k(`
        
        "Captain Roger Bennett," said Bixby, handing me some papers. "Deceased as of last night.
        Retired shortly after capturing one of the chief lieutenants of the
        Black Walrus Society."
  
        I perked up. "Is that so?"
  
        “Mmmm. A rather dangerous scoundrel named Charles Hob."
        
        `):e("hob")?k(`
        
        Bixby returned with a formidable stack of records. "A mayor of wickedness even amongst the filthiest scoundrels.
        Charles Hob, member of the Black Walrus Society. Murder, theft, smuggling, in at least a dozen countries 
        and probably even more we don't know about. Has spent the last six years in St. Helena,
        locked up with 12 of his brethren. It was Captain Bennett who finally caught 'im.
        
        `):e("astl")?k([`
        
        "Have you anything on an R.T. Astley?" I asked.
  
        Bixby dutifully searched and found nothing. "Are you sure that's a person of criminal note?"
  
        "It may not even be a person," I replied, "It was spelled ASTLEY RT at the crime scene."
  
        "Hmph!" Bixby was clearly pleased with himself. "And you call yourself a detective!"
  
        "Do you know the identity of Astley RT?"
  
        "Certainly!" Bixby was now fairly beaming. "And no, it is no person. It is the Astley Royal Theater! The live
        circus show at *11 Westminster*."
  
        "Bixby," I said, "I daresay you are correct!"
        
        `,`
        
        "It is the Astley Royal Theater! The live circus show at *11 Westminster*."
        
        `]):e("werst")?k(`
        
        "No record on her," said Bixby.
        
        `):e("thurm")?k(`
        
        "No record on him," said Bixby.
        
        `):e("bixb")?k(`
        
        "Ha!" chortled Bixby, "Wouldn't you like to know?"
        
        `):e("goul")?k(`
        
        "I'm certain my *superior* should love for me to look him up in this place," said Bixby, "But I must decline."
        
        `):k(`"Haven't got anything on that, I'm afraid," said Bixby.`)}),m("Leave the museum",T("cabbie"))},Game.outsideWarehouse=()=>{k(`

    The warehouse was a peculiarly sinister thorn in the twisted bramble of shadowy brick buildings.

    `),x("enteredWarehouse")||m("Enter the warehouse",()=>{H("enteredWarehouse",!0),k(`

	I entered the warehouse on Spaulding and was met by a wide thick brute of a man.
	"Ay! Your kind isn't welcome in here!"

	`),m('"A woman?"',`

	"Don't matter!" he said, pointing at the door. "Out!"

	`),m('"An oriental?"',`

	"Don't matter!" he said, pointing at the door. "Out!"


	`),m('"An educated citizen?"',`

	"Don't matter!" he said, pointing at the door. "Out!"

	`)}),x("enteredWarehouse")&&m("Enter the warehouse",`

    "What did I tell you before?" shouted the brute as I entered. "Your kind isn't allowed in this place!"

    `),x("stockfordDoomed")||(x("boughtFlower")||k([`

    Standing in the fog-drenched gutter was a delicate little woman in a floral gypsy dress.
    "Flower for sale?" She held out a tiny yellow bloom.

    `,`"I'm certain a flower would brighten your day," said the woman, an insistent tone in her voice.`]),x("boughtFlower")||m("Purchase a flower",()=>{H("boughtFlower",!0),k(`

    I pressed into her hand more pence than is morally sound to spend on a single flower. "Hello,
    Romica," I said.

    "Good day Madame Soo," said Romica in a fractured cockney. "Looking for a suspicious character, I gather?"

    `),m(`"A certain recently deceased sea captain, as if you didn't know."`,()=>{k(`

	"A certain recently deceased sea captain, as if you didn't know," I said.

	"Of course, I don't really *know* anything," said Romica with a coy grin. "But a lowly flower girl from
	far away can go about unobserved, you might say. Almost invisible. But I have my eyes and ears."


	`),m('"What will your surveillance cost me today?"',`

"What will your surveillance cost me today?" I asked.

She whispered something and I produced another absurd sum, which she snatched into her blouse.

"You that should visit a certain Mr Stockford, at Surrey Club."

"The Surrey Club?"

"Captain Bennett was a traitor more than once in his life. Investigating the affairs of the Black Walrus Society can be dangerous, if you get my meaning." She spoke in a lower tone, close to a whisper. "That's why I don't know anything."

	With that, Romica vanished into the fog.

	`),m('"A man is dead and I have no time for games."',`

	"A man is dead and I have no time for games," I said with no small measure of indignation.

	"I would love to help," said Romica, "Desperate times these are. Even the news isn't cheap."

	I groaned and produced another absurd sum.

	"You that should visit a certain Mr Stockford, at Surrey Club."

	"The Surrey Club?"

	"Captain Bennett was a traitor more than once in his life. Investigating the affairs of the Black Walrus Society can be dangerous,
	if you get my meaning." She spoke in a lower tone, close to a whisper. "That's why I don't know anything."

	With that, Romica vanished into the fog.

	`)}),m('"Who do you take me for?"',()=>{k(`

	"Who do you take me for?" I said. "I am of the respectable sort."

	"Of course," said Romica with a wink. "Me too. But a lowly flower girl from
	far away can go about unobserved, in almost any circle. All but invisible. But I have my eyes and ears."


	`),m('"And what will your surveillance cost me today?"',`

	"And what will your surveillance cost me today?" I asked.

	She whispered something and I produced another absurd sum, which she snatched into her blouse.

	"You that should visit a certain Mr Stockford, at Surrey Club."

	"The Surrey Club?"

	"Captain Bennett was a traitor more than once in his life. Investigating the affairs of the Black Walrus Society can be dangerous,
	if you get my meaning." She spoke in a lower tone, close to a whisper. "That's why I don't know anything."

	With that, Romica vanished into the fog.

	`),m('"A man is dead and I have no time for games."',`

	"A man is dead and I have no time for games." I said with no small measure of indignation.

	"I would love to help," said Romica, "Desperate times these are. Even the news isn't cheap."

	I groaned and produced another absurd sum.

	"You that should visit a certain Mr Stockford, at Surrey Club."

	"The Surrey Club?"

	"Captain Bennett was a traitor more than once in his life. Investigating the affairs of the Black Walrus Society can be dangerous,
	if you get my meaning." She spoke in a lower tone, close to a whisper. "That's why I don't know anything."

	With that, Romica vanished into the fog.

	`)})}),m("Catch a cab",T("cabbie")))},Game.scotlandYard=()=>{k(`
    
    Scotland Yard was a gray, unimaginative building of brick and fog, an unextraordinary den
    of ferocious and bloodthirsty bureaucrats.
    
    `),2===x("stockfordDoomed")?m("Find Gould",()=>{const e=()=>{k(`
        
            "Only that our dear Captain was in league with a 
            congress of wickedness." I told him everything I had discovered, including the 
            plea of Stockford for protection.

            He listened with a dark scowl. After considerable silence, he said: "Bennett, a traitor! Are you certain
            we can believe this Stockford chap?"

            "I suspected it from the moment I read the scraps of letters he buried in his rose garden," I said. "He earned the 
            trust of his fellow brigands and greedily reaped the spoils of his expedient criminal trajectory."

            Gould nodded. "When he wanted to return to England, he betrayed everyone who knew the truth to the hangman's noose."

            "That was his hope. But they went to St. Helena instead."
        
        `),m('"Hob has escaped."',()=>{k(`
          
            Gould's expression was grim. "Charles Hob, ringleader of the Black Walrus Society, is here," I continued.
            "Somehow he escaped his fate in captivity and I believe him to be in London."

            "Did he murder Bennett?"

            "No," I answered, "But he most certainly had a supervising hand in planning his grisly demise. To 
            find our missing link, we must locate a man who can fit in a luggage box."

            "A man in a box? Is that how he entered the Captain's room?"  
          
          `),m('"Precisely."',()=>{k(`
            
                "Precisely. Someone—likely someone who was informed of the Captain's increasingly suspicious activities—smuggled
                himself into one of the boxes stored in the warehouse belonging the Bennett."

                "What was he looking for in those boxes?" 
            
            `),a()}),m('"Of course you blind fool."',()=>{k(`

                "Of course you blind fool."

                "You are testing my patience," said Gould with a shade of irritability. "Tell me: what was Bennett looking for in all those luggage boxes?"

            `),a()})})};k(`
      
        Chief Inspector Gould was not in his office, but at Addington's Club across the street. He sat pensively at his usual 
        table, stuffing his pipe with reddish-brown leaves from the coffin of his pocket tobacco box.

        "I perceive you've been quite industrious," I said.

        His weary eyes fixed on me. "And how did you arrive on that inimitable conclusion?"

        "I happen to be the world's most dazzling detective."

        "No, you're not."

      `),m('"Of course I am."',()=>{k(`
        
            "Of course I am," I said. "They call me the nimblest mind in Europe."

            "I fear your abilities have led you by streams into a vast ocean of hubris," said Gould,
            shaking his head. "What have you found out?"
        
        `),e()}),m(`"No, but I'm the best you have at your disposal."`,()=>{k(`
        
            "No, but I'm the best you have at your disposal." I said.

            He sighed. "That is sadly true. What have you found out?"
        
        `),e()})}):(g("scotlandYard")||m("Find Gould",()=>{k(`
          
        Gould appeared with great black pouches beneath his eyes. "Did you sleep, Madame?"
    
        "I slept well," said I. "And I've come to some conclusions. First, that Captain Bennett's 
        murderer did not come through the window. That leaves only one route: the door."
    
        "Which was locked," interjected Gould.
    
        "Correct. Neither the gardener nor the housekeeper saw the villain. Thus: we have a dual-problem;
        how the murderer entered the room, and how he left."
        
        "Simplicity itself," Gould snarled. "If only all our crimes were such trifles."
    
        "I detect you found no rest last night."
    
        "Not a wink." He gave a hoarse laugh. "Not even a morsel of slumber. Thanks to that walrus you showed me, I spent all my bedroom hours
        on a wild goose chase. Nonetheless, it was not without fruit. Come with me."
    
        `),m("Follow Gould down the stairs into a dark passage",()=>{k(`
            
            "I'm taking you to a place most common citizens never see," said Gould. "Officially, it doesn't exist."
    
            "Aha. The Secret Museum of Scotland Yard?"
    
            "Of course, you already know of it," he with some disgust. "Well, it does exist.
            Down here are papers on every criminal case, solved and unsolved, in our history. I've placed a friend
            here to help you today while I deal with the official inquiry."
            
            `),m("Continue downstairs",()=>{k(`
              
                Finally we emerged into a vast underground maze of savagery, mayhem and murder. "Here we are,"
                said Gould, "The Secret Museum. In here, we collect all there is to know about crime in this benighted city,
                on and off the record."

                Bixby met me with his usual grimace. "And because of you, China Doll, I have to spend a whole murder investigation
                in the basement. Well done."

                "I've placed Bixby down here, just for today, to assist your research," said Gould. "I've already asked him to get 
                ready on the Black Walrus papers. And though it goes without saying, be careful—these fellows are a vicious lot."

                Gould left up the stairs, leaving me with Bixby.
              
              `),m("Let's get to work",T("museum"))})})}),g("scotlandYard")&&x("stockfordDoomed")<2&&m("Enter the museum",T("museum"))),m("Catch a cab",T("cabbie"))},Game.start=()=>{k(`

    ## Secret of the
    # Black Walrus
    
    ### A game by spaceflounder
    
    `),m("First Time Playing",T("firstTime")),m("Start",T("intro1")),m("I've played before, take me straight to the crime scene",T("manorHouseFoyer"))},Game.firstTime=()=>{k(`

    ### Tips for First Time Detectives
    `),I("❧ Write down every clue during your investigation. The best crime-solvers use a pen and paper!"),I("❧ Talk to everyone. It may be helpful to talk to some characters more than once."),I(`❧ Near the end of the story, you will be asked to identify the villain.
    It is technically possible to lock yourself out of victory, so be sure you've caught the right suspect.`),m("I'm ready to solve the mystery",T("start"))},Game.intro1=()=>{k(`

    ### London Chinatown, 1884

    You've never read about me in the papers, or in any journal. You can
    call me Madame Soo. Sometimes, at Scotland Yard, they call me the China Doll.
    They are not entirely a bad lot, I suppose. But when the police find 
    themselves truly baffled, they come to me.

    It was late. I was in my small parlour off of West India Dock Road. There was an urgent knock at the door.
    
    `),m("Open the door",T("intro2")),m("Wait",T("intro1_1"))},Game.intro1_1=()=>{k(`

    The rap on my door came again, more insistent this time.
    
    `),m("Open the door",T("intro2")),m("Wait",T("intro1_1"))},Game.intro2=()=>{k(`

    Chief Inspector Gould's face appeared in the dim moonlight.
    "Good evening, Madame Soo," he said, entering as
    swiftly as he could and shutting the door behind him.

    "Good evening, Inspector," I replied. As a tall
    pale gaunt Englishman, he possessed superior skill in looking dour.
          
    `),m('"This is scarcely a decent hour."',()=>{k(`
    
    "This is scarcely a decent hour," I said. "Nearly a quarter of eight."

    "True," said the Inspector, "But this is scarcely a decent place. I should be quite gay indeed not to 
    venture deep into Limehouse each time I needed your inimitable skills."

    `),m('"Then I shall assume the matter is of murder."',()=>{k(`
        "Then I shall assume the matter is of murder," I said, "And likely a figure of some importance."
      `),T("intro3")()}),m(`"You've come for a social call, then?"`,()=>{k(`
      
      I favoured him with a wry grin. "You've come for a social call, then?"
      
      `),T("intro3_1")()})}),m(`"Shouldn't you be at the Underwood Club?"`,()=>{k(`
    
    "Shouldn't you be at the Underwood Club?" I asked. "Surely Merrington and his fellows are grieved
    to have lost their favored pigeon at whist."

    "Ha, ha." Gould was hardly pleased. "One day I shall be most glad to ascertain how you have come
    to be aware of my whist habits, or my associates, as Underwood is a private gentleman's club."

    "You're at a loss, as I have never entered the club myself, for I am no gentleman.".

    "For a certainty you are not."
    
    `),m('"I presume you are here to engage my skills."',()=>{k(`
        "I presume you are here to engage my skills," I said. "And I would further surmise the nature of the crime
        is quite serious."
      `),T("intro3")()}),m(`"You've come for a social call, then? It is quite late."`,()=>{k(`
      
      I favoured him with a wry grin. "You've come for a social call, then? It is quite late."
      
      `),T("intro3_1")()})})},Game.intro3=()=>{k(`
          
  "You are wholly correct," said Gould, his face grim. "Might I convey the particulars of the case
  on the way? I have a hansom waiting for us." 


    `),m('"I will exact my usual fee, of course."',T("intro4"))},Game.intro3_1=()=>{k(`
          
  "More sparks of keen wit," said Gould with a vexed sigh. "Come, we have work to do. I have a hansom waiting for us." 

    `),m('"I will exact my usual fee, of course."',T("intro4"))},Game.intro4=()=>{k(`
          
  I nodded. "I will exact my usual fee, of course."

  "Per our usual arrangement," said the Inspector. Soon we were out of my parlour and in the wet dark
  of winter in Canary Wharf. The air was thick with tar and cheap tobacco. The dock never sleeps.

  The cabbie nodded as we took our seats, and with a flick of his wrist we were headed
  north. "You've heard of Captain Roger Bennett?"

    `),m(`"Captain Bennett, of the Queen's Navy?"`,()=>{k(`
    
    "Captain Bennett, of the Queen's Navy?" I replied.

    "The same," said Gould, "Though he was more a privateer than the heroic sea commander you've been regaled of in the papers.
    Bennett was a bachelor, living with a housekeeper and a gardener. At about half past six this evening he retired to his
    bedroom. The door to his room was shut and locked. A few minutes later, the housekeeper, a certain
    Mrs. Werstrom, heard an awful scream from the bedroom."
    
    `),m('"Was the door still locked?"',()=>{k(`
        
        "Was the door still locked?" I asked.

        "It was," said Gould, "The gardener, Mr. Thurman, is a capable man and handy with tools. He removed the knob and they
        found Bennett perished by strangulation in his bed."
        
        `),m('"I assume the crime scene is as you found it."',T("intro5"))})}),m(`"I've heard of him."`,()=>{k(`
    
    "I've heard of him," I said.

    Gould nodded. "In truth, he was more a privateer than the navy man you've read about in the papers.
    Bennett was a bachelor, living with a housekeeper and a gardener. At about half past six this evening he retired to his
    bedroom. The door to his room was shut and locked. A few minutes later, the housekeeper, a certain
    Mrs. Werstrom, heard an awful scream from the bedroom."
    
    `),m('"And the door was still locked."',()=>{k(`
        
        "And the door was still locked," I said.

        "It was," said Gould, "The gardener, Mr. Thurman, is a capable man and handy with tools. He removed the knob and
        found Bennett perished by strangulation in his bed."
        
        `),m('"I assume the crime scene is as you found it."',T("intro5"))})})},Game.intro5=()=>{k(`

      I nodded. "I assume the crime scene is as you found it."

      "Exactly as we found it," said the Inspector. "Mrs. Werstrom and Mr. Thurman are also present to interview."
    
    `),m('"Excellent!"',T("intro6"))},Game.intro6=()=>{k(`

      "Excellent!" I said. "Thank you, Chief Inspector."

      "I shall only hope you may shed some light on this strange and sinister business," said Gould with a dark scowl.
      
      Soon our hansom arrived at the gate of a wide rolling lawn, blue under the light of the moon. Beyond the lawn
      was a tall manor house, a black shadowy tower by night.

      "Stay here," Gould instructed the cabbie as we departed, "I'll be back shortly."
    
    `),m("Proceed to the manor house",T("intro7"))},Game.intro7=()=>{k(`

      We stood on a wide stone porch in nearly total darkness. The door swung open to reveal
      Detective Sergeant Bixby, Gould's usual confederate. Whereas Gould exhibited occasional glimmers
      of brilliance, Bixby had a mind like a lightless cellar.

      "Good news, Chief Inspector," he said. "I've cracked the case. It would seem you've fetched the
      China Doll in vain."
      
    `),m('"Most pleased to see you as well, Bixby."',()=>{k('"Most pleased to see you as well, Bixby," I grumbled.'),T("intro8")()}),m('"Hmm. What is your theory, Mr. Bixby?"',()=>{k('I was more curious than offended. "Hmm. What is your theory, Mr. Bixby?"'),T("intro8")()})},Game.intro8=()=>{k(`

      "The case is simplicity itself," said Bixby with a broadening grin. Bixby was
      fairly young for his position, though he appeared older owing to some girth
      and a slick copper mustache. "As you no doubt recall, Mrs. Werstrom discovered the body."

      "She did indeed," nodded Gould.

      "How do we know she isn't the murderer?"

      "The 90 pound, 60-year old housekeeper managed to choke the still-robust captain of
      the Royal Navy," said Gould. "I think we may perhaps have some keener results from the
      so-called China Doll, eh Madame Soo?"
      
    `),m("Enter the house",()=>{k(`
    
    "I've business still at Scotland Yard, so I must leave," said Gould to me, "But I shall return later tonight
    to confer on the investigation. Bixby," he addressed the assistant deputy, "Please ensure Madame
    Soo has everything she asks for. She is in charge in my absence."

    Bixby mumbled something I was glad to not have heard.
    
    `),m('"Thank you, Chief Inspector. I shall examine the crime scene in your absence."',()=>{k(`

      Gould left for the hansom and I stepped inside. I found
      the captain's taste both opulent and international. Large brass Arabic lamps flickered gently over
      lavish French furniture and Cantonese rugs. The home reflected the
      man himself; well traveled, and pilfering trinkets where-ever he went.  
      
      `),T("manorHouseFoyer")()}),m('"Can you put Officer Bixby under my authority on a more permanent basis?"',()=>{k(`

      Gould vanished into the dark and Bixby shot me a look of scarcely contained rage. "Perhaps,
      China Doll, you'll one day get your comeuppance."

      I stepped inside, and the relentless chill of the night began to fade.
      I found the captain's taste both opulent and international. Large brass Arabic lamps flickered gently over
      lavish French furniture and Cantonese rugs. The home reflected the
      man himself; well traveled, and pilfering trinkets where-ever he went.  
      
      `),T("manorHouseFoyer")()})})},Game.streetsOfLondon=()=>{k(`

    The morning was cold. A heavy roll of fog covered the cobblestone streets, damp and gray.
    
    My mind was steeped in the horrors of the previous night.
    The sea hero, dead in his own bed. The box in the rose garden. That strange, sinister mark
    of the walrus.

    `),m("Call a cab",T("cabbie"))},Game.surrey=()=>{1!==x("stockfordDoomed")&&k(`
    
    An dim little club composed of sooty gray stones stood on the corner, consumed in smoke and fog.
    The air was dingy and uncongenial.        
    
    `),1===x("stockfordDoomed")&&(k(`
        
            "Another blossom, Madame?" came a voice from behind me. Romica was waiting as I emerged from 
            the Surrey Club.

            "I have no need of flowers," I said. "And can scarcely afford them anyways."

            "No, you're right," she said. "You just need a little spin in the right direction."

            "And how much will that cost me?"

            "For you, Madame? Only nothing."

            My patience was dwindling. "I've precious little time for mischief. Presently I'm off to Scotland Yard in due haste."

            "Why for?" Romica tilted her head with a savage smile. "To save him, in there? He's as good as dead."

            And just like that, she was gone again.
        
        `),H("stockfordDoomed",2)),m("Enter the club",T("insideClub")),m("Catch a cab",T("cabbie"))},Game.insideClub=()=>{k(`
    
    Inside, the Surrey Club hung heavy with tobacco and opium. The patrons were not a respectable sort; they sat quietly, ensconced in a fume
    of pathetic iniquity.
    
    `),m("Leave the Surrey Club",T("surrey"))},Game.talkToThurman=()=>{k(`
      
      Thurman was a hearty man with curly hair and glinting eyes that had a hint of Irish to them.
      He sat in the den by the fire, slumped in an armchair, sleepless but exhausted. 
      
      `),e('"Thank you for meeting with me."',`

      "Thank you for meeting with me," I said.
      
      Thurman shrugged. "Of course. Though if you don't mind me saying, Madame, you
      don't seem much like the Scotland Yard sort."
      
      `),e('"Did you discover the body?"',`

    "Did you discover the body?" I asked.
      
      "No." Thurman's face grew pallid. "Mrs. Werstrom... He locked himself in his room and she
      heard a dreadful scream."

      "Did it sound like his voice?"

      "It was the Captain, for certain. I broke the lock, but it was too late." His eyes were haunted. "There was not
      a living soul in that room, Madame."

      "And after that, you contacted Scotland Yard?"

      "I walked to Dent's and sent Abbot to get help. He did so remarkably fast."
      
      `),m('"Did Captain Bennett have any enemies?"',[`
      "Did Captain Bennett have any enemies?" I asked.
      
      "He was in the Royal Navy," said Thurman. "Of course he did. But no-one I was aware of in London."
      
    `,`      
      "No-one I was aware of in London."
    `]),m(`"Was there any reason to believe Captain Bennett's life was under threat?"`,()=>{H("roseGarden",!0),k([`

      "Was there any reason to believe Captain Bennett's life was under threat?" I asked.
      
      "No, though he was acting strangely for the last couple of weeks," said Thurman. "Though,
      not in any big ways." He paused for a moment to think. "Little things. He was spending more
      and more time in the rose garden on the northeast side of the lawn. By himself. Always seemed
      jumpy when others were about. The captain was a private man and we never pried into his business."
      
    `,`
    
      "No, but he was spending more and more time in the rose garden on the northeast side of the lawn."
    
    `])}),m('"Thank you for your assistance, Mr. Thurman."',T("manorHouseFoyer"))},Game.talkToWerstrom=()=>{k(`
        
        Mrs. Werstrom sat in the kitchen, her haggard face lit by dim candlelight. 
        
        `),e('"Thank you for meeting with me."',`
  
        "Thank you for meeting with me," I said. "I've only a few questions."
        
        Mrs. Werstrom merely shook her head. "Poor blighter."
        
        `),m('"Did Captain Bennett have any enemies?"',[`
        "Did Captain Bennett have any enemies?" I asked.
        
        Mrs. Werstrom was silent for a long time. "We all knew the Captain had enemies. And secrets.
        Dark secrets."
        
      `,`      
      "We all knew the Captain had enemies. And secrets.
      Dark secrets."
      `]),e('"Can you describe the events leading up to the murder?"',`
    
        "Can you describe the events leading up to the murder?" I asked.
          
        "The Captain retired early this evening," said Mrs. Werstrom. "Locked himself in his room.
        I heard a terrible scream after that."
        
        "And it was Mr. Thurman who managed to get the door open after it had been locked and shut?"

        She nodded.

        "But you entered first?"

        Her eyes were rimmed with hysteria, and her lips refused to move.

        I nodded. "Thank you, Mrs. Werstrom."

        `),m(`"Was there any reason to believe Captain Bennett's life was under threat?"`,()=>{H("foundBankAddress",!0),k([`
  
        "Was there any reason to believe Captain Bennett's life was under threat?" I asked.

        "I knew something was amiss," she said. "He kept receiving letters that seemed to agitate him."

        "Agitate him how?"

        "He was as a caged animal," said Mrs. Werstrom. "Almost as if he were being watched."

        I thought on that for a moment.

        "He also spent a very good deal of time at the warehouse," Mrs. Werstrom continued. "That's where
        all the trunks upstairs came from. Trunks and trunks of goods from all over the world. Bring 'em
        back 'ere and sort through him in his bedroom."

        "What was he searching for?"

        "No idea, Miss."

        "Can you tell me where to find this warehouse?"

        After a moment of looking through the Captain's papers, she returned with an address:

        *132 Spaulding Road*
        
        
      `,`
      
          She showed me an envelope with a carelessly scrawled return address:

          *132 Spaulding Road*

      `])}),m('"Thank you, Mrs. Werstrom."',T("manorHouseFoyer"))},window.addEventListener("load",()=>{var e;r={...Game},(e=document.createElement("div")).className="topBar",e.onclick=t,document.body.appendChild(e),u(),T("cabbie")()}),(e,t)=>{const a="d"+o(e);r[a]||m(e,()=>{r[a]=!0,"function"==typeof t?t():k(t)})});const l=()=>{document.getElementsByClassName("main")[0].remove(),r.buttonCount=0},u=()=>{let e=document.getElementsByClassName("topRoot")[0];var t=document.createElement("div"),a=document.createElement("div"),o=document.createElement("btns");e||((e=document.createElement("div")).className="topRoot",document.body.appendChild(e)),e.appendChild(t),t.className="main",t.id="main",a.className="page",a.id="page",o.className="btns",o.id="btns",e.appendChild(t),t.appendChild(a),t.appendChild(o)},c=()=>{!r.env||!r.isTalking&&r.buttonCount||k(r.env())},m=(o,n,e)=>{var t=document.getElementById("btns");if(!(t&&o&&n))throw"Button could not be constructed! With options: "+o;r.buttonCount||(r.buttonCount=0),r.buttonCount+=1,o=o.trim();var a=document.createElement("button");a.type="button",a.onclick=()=>{var e=document.getElementsByClassName("main")[0].innerHTML,t=(l(),r.isTalking&&(t=d?.state??"talk",a=d[t]["btn-"+o]??0,r.lastButtonPressed=o,d[t]["btn-"+o]=a+1),document.createElement("div")),a=(t.className="outPage",t.id="outPage",t.innerHTML=e,document.getElementsByClassName("topRoot")[0]);a&&a.appendChild(t),setTimeout(()=>{document.getElementById("outPage").remove(),window.scrollTo(0,0),u(),"function"==typeof n?n():k(n),c(),!r.buttonCount&&r.lastNode&&m("➜",()=>{r.lastNode&&r.lastNode()})},650)},a.className="button",a.innerHTML=`<div class='buttonText'>${h(o,!0)}</div>`,e?t.prepend(a):t.appendChild(a)},s=e=>e[0].toUpperCase()+e.slice(1);const y=e=>(e=e||r.isTalking,p(e)?[r[e].name,"","",""]:[r[e].name,"a","the","that"]),f=(e,t)=>{t=t||r.isTalking,r[t].name=e},p=e=>(e=e||r.isTalking,r[e].hasMet);const w=(e,t)=>{e=e??"talk";t=t||r.isTalking,r[t].state=e,r.isTalking===t&&(r.lastNode=r[t][e])},g=e=>{return e=e||r.currentLocationName,r[e].visited??0};const b=(e,t)=>{m(e,()=>{t?(t(),m("➜",()=>{T(r.currentLocationName)(),r.isTalking=""})):(T(r.currentLocationName)(),r.isTalking="")})};const v=(o,n)=>{var e=document.getElementById("btns");if(e&&o&&n){r.buttonCount||(r.buttonCount=0),r.buttonCount+=1,o=o.trim();var t=document.createElement("form");const s=document.createElement("input");var a=document.createElement("input"),i=document.createElement("div");t.className="inputForm",i.className="inputLabel",i.innerHTML=h(o),s.type="text",s.action="javascript:void(0)",s.className="inputString",a.action="javascript:void(0)",a.type="submit",a.className="submit",a.hidden=!0,a.onclick=e=>{e.preventDefault();var e=document.getElementsByClassName("main")[0].innerHTML,t=(l(),r.isTalking&&(t=d?.state??"talk",a=d[t]["btn-"+o]??0,r.lastButtonPressed=o,d[t]["btn-"+o]=a+1),document.createElement("div")),a=(t.className="outPage",t.id="outPage",t.innerHTML=e,document.getElementsByClassName("topRoot")[0]);a&&a.appendChild(t),setTimeout(()=>{document.getElementById("outPage").remove(),window.scrollTo(0,0),u();var e=s.value.toLowerCase().replace(/\s/g,"");n(e),c(),!r.buttonCount&&r.lastNode&&m("➜",()=>{r.lastNode&&r.lastNode()})},450)},t.appendChild(i),t.appendChild(s),t.appendChild(a),e.appendChild(t)}},k=e=>{var t=document.getElementById("page");if(t)if(Array.isArray(e)){var a=e;const s=a[0];var o="i"+(()=>{let e=0;if(0!=s.length)for(i=0;i<s.length;i++){var t=s.charCodeAt(i);e=(e<<5)-e+t,e&=e}return e})(),n=r[o]??0;n?(k(a[n]),n<a.length-1&&(r[o]=n+1)):(r[o]=1,k(s))}else"string"==typeof e?t.innerHTML+=h(e):"function"==typeof e&&(t.innerHTML+=h(e()))},I=e=>{var t,a=document.getElementById("page");a&&((t=document.createElement("div")).className="spacedMsg",t.innerHTML=h(e,!0),a.appendChild(t))},T=t=>{const a=()=>{Object.keys(r).map(e=>{var t,a;r[e]?.location&&r.currentLocationName===r[e]?.location&&(t=(e=>{e=e||r.isTalking;var[t,,a]=y(e),o=r[e].state??"talk";if(!p(e)&&r[e].notMet){if("function"==typeof r[e].notMet)return r[e].notMet();if("object"==typeof r[e].notMet&&r[e].notMet[o]){if("function"==typeof r[e].notMet[o])return r[e].notMet[o]();if("string"==typeof r[e].notMet[o])return r[e].notMet[o]}return r[e].notMet??s(a+` ${t} is here.`)}if("function"==typeof r[e].desc)return r[e].desc();if("object"==typeof r[e].desc&&r[e].desc[o]){if("function"==typeof r[e].desc[o])return r[e].desc[o]();if("string"==typeof r[e].desc[o])return r[e].desc[o]}return r[e].desc??s(a+` ${t} is here.`)})(e),k(t),r[e].talk)&&m((e=>{e=e||r.isTalking;var[t,,a,,]=y(e);return r[e].talkLabel?"string"==typeof r[e].talkLabel?r[e].talkLabel:r[e].talkLabel():`Talk to ${a} `+t})(e),(a=e,()=>{r.isTalking=a,(d=r[a]).hasMet=!0;var e=d?.state??"talk";1!==r?.map?.length||r.showFastTravelTip||(r.showFastTravelTip=1),r[a][e](),r.lastNode=r[a][e]}),!0)})};return()=>{r.currentLocationName=t;var e=()=>{var e=r[t]?.visited??0;r.env=null,r.isTalking="",r[t](),a(),r[t].visited=e+1,1===r.showFastTravelTip&&r[r.map[0]].location!==r.currentLocationName&&(r.showFastTravelTip=2,B("Hey there! You can now fast travel to characters you meet by tapping the top ⤴ of the screen"))};e(),r.lastNode=e}};const C=e=>{var t=`p{${o(e.join("-"))}}`;return r[t]&&r[t]?.length||(r[t]=(e=>{let t=e.length,a;for(;0!=t;)a=Math.floor(Math.random()*t),t--,[e[t],e[a]]=[e[a],e[t]];return e})([...e])),r[t].pop()},B=e=>{const t=document.createElement("div");t.className="tipBox",t.id="tipBox";var a=document.createElement("div"),o=(a.className="tipInnerBox",a.id="tipInnerBox",document.createElement("div"));o.className="tipInnerText",o.id="tipInnerText",o.innerText=e,a.appendChild(o),t.appendChild(a),t.onclick=()=>t.remove(),document.body.appendChild(t)},x=e=>(r.values||(r.values={}),r.values[e]??!1),H=(e,t)=>{r.values||(r.values={}),r.values[e]=t};